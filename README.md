# DPI & Connectivity Tester

Интерактивный Python-скрипт для комплексной проверки доступности веб-ресурсов и диагностики различных видов интернет-блокировок, включая DNS-блокировки, блокировки по IP/SNI и вмешательство систем глубокого анализа трафика (DPI).

## Возможности

-   **Комплексное тестирование**: Проводит серию тестов для одного ресурса, не останавливаясь на первой ошибке.
-   **Множественные векторы проверки**: Анализирует доступность по DNS, TLS 1.3/1.2, валидность SSL-сертификата, HTTP-ответ и специфичные DPI-атаки.
-   **Геолокация сервера**: Автоматически определяет страну и город расположения сервера по его IP-адресу.
-   **Пользовательские списки**: Позволяет добавлять и сохранять собственные URL для тестирования. Файл `user_sites.txt` создается автоматически.
-   **Понятный вывод**: Предоставляет детализированный отчет по каждому тесту и выносит итоговый вердикт о наиболее вероятной причине проблемы.
-   **Минимум зависимостей**: Требует только `requests` и `dnspython`.

## Установка

1.  **Требования**: У вас должен быть установлен Python 3.6 или новее.

2.  **Установка зависимостей**:
    ```bash
    pip install requests dnspython
    ```

## Использование

Запустите скрипт из вашего терминала:
```bash
python dpi_checker.py
```
Вы увидите меню с несколькими опциями:
-   **1. Полная проверка по стандартному списку сайтов**: Запускает тесты для предустановленного списка популярных и тестовых ресурсов.
-   **2. Полная проверка сайтов из вашего списка**: Запускает тесты для всех URL, которые вы добавили в файл `user_sites.txt`.
-   **3. Добавить и проверить новый сайт**: Позволяет ввести новый URL, который будет добавлен в ваш список и немедленно проверен.
-   **4. Справка по результатам**: Выводит подробное описание всех тестов и возможных вердиктов.
-   **0. Выход**: Завершает работу скрипта.

## Интерпретация результатов

После выбора опции для тестирования вы увидите отчет для каждого сайта, похожий на этот:

<img width="394" height="252" alt="image" src="https://github.com/user-attachments/assets/c4f49fa5-aa55-4f87-9f17-6f99a5782e07" />


### Объяснение каждой строки:

-   `DNS:` Результат запроса к публичным DNS-серверам. `OK` означает, что IP-адрес получен. `Ошибка` говорит о проблеме с получением IP.
-   `Локация:` Страна и город, где расположен сервер, по данным сервиса ip-api.com.
-   `TLS 1.3 / 1.2:` Проверяет возможность установки соединения по конкретной версии TLS. `Blocked` может указывать на попытку провайдера ограничить использование современных протоколов шифрования.
-   `SSL:` Проверяет полное TLS-рукопожатие и подлинность сертификата.
    -   `OK ✅`: Сертификат валиден.
    -   `Подмена сертификата ❌`: Обнаружен недоверенный сертификат — явный признак MITM-атаки (часто используется DPI).
    -   `Ошибка (...) ❌`: Соединение было сброшено или не установлено. `ConnectionResetError` часто указывает на блокировку по IP или SNI.
-   `HTTP:` Результат GET-запроса *после* установки TLS-соединения. `Ошибка` на этом этапе — классический признак DPI, который фильтрует трафик внутри зашифрованного канала.
-   `DPI (16KB):` Результат теста, имитирующего скачивание файла. `Detected` означает, что соединение было разорвано после передачи небольшого объема данных (~16-24 КБ).
-   `Вердикт:` Итоговое заключение, основанное на совокупности результатов.

### Возможные вердикты:

| Вердикт                          | Значение                                                                                                    |
| -------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| **DNS-блокировка**               | Не удалось получить IP-адрес домена.                                                                        |
| **Блокировка по IP / SNI**       | DNS-запрос успешен, но TCP/SSL-соединение было сброшено на самом раннем этапе.                               |
| **Блокировка 'black-hole'**      | Запросы к серверу не получают ответа (таймаут). Трафик просто отбрасывается.                                |
| **Подмена SSL (DPI/MITM)**       | Обнаружен поддельный SSL-сертификат. Явный признак атаки 'человек посередине'.                               |
| **Блокировка по DPI (HTTP)**     | DNS и SSL-соединение успешны, но HTTP-запрос внутри защищенного канала блокируется.                         |
| **DPI (разрыв при скачивании)**  | Выявлен специфический тип DPI, рвущий соединение при попытке скачать файл.                                   |
| **Доступен**                     | Все ключевые тесты (DNS, SSL, HTTP) прошли успешно.                                                         |

### Отказ от ответственности

Результаты теста могут зависеть от вашего интернет-провайдера, текущего состояния сети и настроек удаленного сервера. Этот инструмент предназначен для диагностических целей.

# Авторство

При разработке кода скрипта брался за основу репозиторий: https://github.com/hyperion-cs/dpi-checkers и https://github.com/gitnabi/dpi-probe
